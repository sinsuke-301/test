# 学习目标：

<font color=#999AAA >1.完成绝大部分静态页面的布局
2.了解学习ajax的功能，学习升级需求功能的相关知识
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

# 学习内容：

<font color=#ff7b3f >1.关于nodemon的安装问题（实现修改js代码保存时重启服务器）

输入以下代码：
```javascript
npm install -g nodemon
```
这个时候会出现在此系统禁止运行脚本的问题，解决办法如下：
1.以管理员身份打开vscode
2.输入：set-ExecutionPolicy RemoteSigned
3.y回车
4.重新打开集成终端，输入nodemon server.js，即成功
（b站的弹幕有时候的帮助也很大）
<font color=#ff7b3f >2.同源策略（获取用户数据）

```html
<h1>首页</h1>
    <button>点击获取用户数据</button>
    <script>
        const btn = document.querySelector('button');
        btn.onclick = function () {
            const x = new XMLHttpRequest();
            //这里因为满足同源策略，所以url可简写
            x.open("GET", '/data');
            //发送
            x.send();
            x.onreadystatechange = function () {
                if (x.readyState === 4) {
                    if (x.status >= 200 && x.status < 300) {
                        console.log(x.response);;
                    }
                }
            }
        }
    </script>
```

```javascript
const { request, response } = require('express');
const express = require('express');

const app = express();

app.get('/home', (request, response) => {
    //响应一个页面
    response.sendFile(__dirname + '/index.html');
});

app.get('/data', (request, response) => {
    response.send('用户数据');
})

app.listen(9000, () => {
    console.log("服务已经启动。。。");
});
```
<font color=#ff7b3f >3.原生jsonp实践

```javascript
用户名：<input type="text" id="username">
    <p></p>
    <script>
        //获取input元素
        const input = document.querySelector('input');
        const p = document.querySelector('p');
        //声明handle函数
        function handle(data) {
            input.style.border = "solid 1px blue";
            //修改p标签的提示文本
            p.innerHTML = data.msg;
        }
        //绑定事件 onblur(丧失焦点)
        input.onblur = function () {
            //获取用户的输入值
            let username = this.value;
            //向服务端发送请求 检测用户名是否存在
            //1.创建script标签
            const script = document.createElement('script');
            //2.设置标签的src属性
            script.src = 'http://127.0.0.1:5000/check-username';
            //3.将script插入到文档中
            document.body.appendChild(script);
        }
    </script>
```

```javascript
const { request, response } = require('express');
const express = require('express');

const app = express();

//jsonp服务
app.all('/jsonp-server', (request, response) => {
    // response.send('console.log("hello jsonp")');
    const data = {
        name: 'hahahahha'
    };
    //将数据转换为字符串
    let str = JSON.stringify(data);
    //返回结果
    response.end(`handle(${str})`);
})
// jsonp跨域原理
//这里返回的结果形式：函数调用
//函数前端需要提前声明

//用户名是否存在检测
app.all('/check-username', (request, response) => {
    // response.send('console.log("hello jsonp")');
    const data = {
        exist: 1,
        msg: '用户名已存在'
    };
    //将数据转换为字符串
    let str = JSON.stringify(data);
    //返回结果
    response.end(`handle(${str})`);
});
app.listen(5000, () => {
    console.log("服务已经启动。。。");
});
```
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">


